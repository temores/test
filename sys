# Solicitar la nueva configuración de red
$NewIPAddress = Read-Host "Ingrese la nueva dirección IP"
$SubnetMask = Read-Host "Ingrese la máscara de subred (ej. 24 para /24)"
$Gateway = Read-Host "Ingrese la puerta de enlace"
$PrimaryDNS = Read-Host "Ingrese el DNS Primario"

# Obtener el adaptador de red activo
$Adapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }

if ($Adapter) {
    # Configurar la nueva dirección IP
    $InterfaceIndex = $Adapter.ifIndex
    New-NetIPAddress -InterfaceIndex $InterfaceIndex -IPAddress $NewIPAddress -PrefixLength $SubnetMask -DefaultGateway $Gateway -Confirm:$false

    # Configurar DNS Primario
    Set-DnsClientServerAddress -InterfaceIndex $InterfaceIndex -ServerAddresses $PrimaryDNS

    Write-Host "Dirección IP configurada: $NewIPAddress" -ForegroundColor Green
    Write-Host "DNS Primario configurado: $PrimaryDNS" -ForegroundColor Green
} else {
    Write-Host "No se encontró un adaptador de red activo." -ForegroundColor Red
    exit
}

# Solicitar el nuevo nombre del host
$NewHostname = Read-Host "Ingrese el nuevo nombre de host"

# Cambiar el nombre del host
Rename-Computer -NewName $NewHostname -Force
Write-Host "El nombre del servidor ha sido cambiado a $NewHostname" -ForegroundColor Green

# Descargar BgInfo desde Sysinternals
$BgInfoUrl = "https://download.sysinternals.com/files/BgInfo.zip"
$BgInfoZip = "$env:TEMP\BgInfo.zip"
$BgInfoPath = "C:\BgInfo"

# Crear la carpeta destino
if (!(Test-Path -Path $BgInfoPath)) {
    New-Item -ItemType Directory -Path $BgInfoPath | Out-Null
}

# Descargar BgInfo
Write-Host "Descargando BgInfo desde Sysinternals..."
Invoke-WebRequest -Uri $BgInfoUrl -OutFile $
